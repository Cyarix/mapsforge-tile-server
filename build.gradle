apply plugin: 'java'
apply plugin: 'distribution'

sourceCompatibility = 1.8
targetCompatibility = 1.8
version = '0.1'

sourceSets {
  main {
    java {
      srcDir 'src'
    }
  }
}

repositories {
  flatDir {
    dirs 'lib'
  }
}

dependencies {
  compile name: 'annotations'
  compile name: 'args4j', version: '2.+'
  compile 'guava:guava:17.+'
  compile 'org.mapsforge:mapsforge-core:0.5.0-SNAPSHOT'
  compile 'org.mapsforge:mapsforge-map:0.5.0-SNAPSHOT'
  compile 'org.mapsforge:mapsforge-map-reader:0.5.0-SNAPSHOT'
  compile 'org.mapsforge:mapsforge-map-awt:0.5.0-SNAPSHOT'
  compile 'io.netty:netty-all:4.0.19.Final'
  compile name: 'sqlite4java'
}

jar {
  manifest.attributes("Main-Class": "develar.mapsforgeTileServer.MapsforgeTileServer", 'Class-Path': "lib/" + configurations.compile.files.collect { it.name }.join(' lib/'))
  archiveName 'mapsforge-tile-server.jar'
}

distributions {
  main {
      contents {
          from { 'dist' }
          from jar

          into('lib') {
            from('lib') {
              exclude '**/*-sources.jar', '**/*-src.zip'
            }
          }
      }
  }
}